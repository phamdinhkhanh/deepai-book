
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. Khởi tạo dataframe &#8212; Deep AI KhanhBlog</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="canonical" href="https://phamdinhkhanh.github.io/deepai-book/ch_appendix/appendix_pandas.html" />
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Numpy" href="index_numpy.html" />
    <link rel="prev" title="2. Pandas" href="index_pandas.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://phamdinhkhanh.github.io/deepai-book/ch_appendix/appendix_pandas.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="2.1. Khởi tạo dataframe" />
<meta property="og:description" content="2.1. Khởi tạo dataframe  Đây là cách thường ít được áp dụng vì khi làm việc chúng ta thường đọc dữ liệu từ những file dữ liệu có sẵn được lưu dưới dạng csv hoặc" />
<meta property="og:image"       content="https://phamdinhkhanh.github.io/deepai-book/_static/img.jpg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/img.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Deep AI KhanhBlog</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Lời nói đầu
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Giới thiệu
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../contents.html">
   Các chương dự kiến
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contents.html#dong-gop-vao-du-an">
   Đóng góp vào dự án
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_intro/main_contents.html">
   Mục tiêu cuốn sách
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../latex.html">
   Latex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../latex.html#tham-khao-latex">
   Tham khảo latex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../grossary.html">
   Bảng thuật ngữ
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Phụ lục
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="appendix_dtypes.html">
   1. Định dạng dữ liệu
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_dtypes_basic.html">
     1.1. Các định dạng số, boolean và ký tự
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_dtypes_basic.html#dinh-dang-sequence">
     1.2. Định dạng sequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_dtypes_basic.html#tom-tat">
     1.3. Tóm tắt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_dtypes_basic.html#bai-tap">
     1.4 Bài tập
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_dtypes_basic.html#tai-lieu-tham-khao">
     1.5. Tài liệu tham khảo
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index_pandas.html">
   2. Pandas
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. Khởi tạo dataframe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#thao-tac-voi-dataframe">
     2.2. Thao tác với dataframe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#reshape-dataframe-tren-pandas">
     2.3. Reshape dataframe trên pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#thong-ke-theo-nhom-tren-pandas">
     2.4. Thống kê theo nhóm trên pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#join-merge-va-concatenate-bang">
     2.5. Join, Merge và Concatenate bảng
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#ket-noi-sql">
     2.6. Kết nối SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#tong-ket">
     2.7. Tổng kết
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#bai-tap">
     2.8. Bài tập
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#tai-lieu">
     2.9. Tài liệu
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="index_numpy.html">
   3. Numpy
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html">
     3.1. Khởi tạo một mảng trên numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#doc-va-save-numpy-tu-file">
     3.2. Đọc và save numpy từ file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#truy-cap-mang-tren-numpy">
     3.2. Truy cập mảng trên numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#thay-doi-shape-cua-mang">
     3.3. Thay đổi shape của mảng
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#cac-ham-tren-numpy">
     3.4. Các hàm trên numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#cac-ma-tran-dac-biet">
     3.5. Các ma trận đặc biệt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#cac-phep-toan-tren-ma-tran">
     3.6. Các phép toán trên ma trận
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#id1">
     3.7. Các phép toán trên ma trận
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#cac-phep-toan-tren-vec-to">
     3.8. Các phép toán trên véc tơ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#thanh-phan-cua-mang">
     3.9. Thành phần của mảng
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#bai-tap">
     3.10. Bài tập
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_numpy.html#tai-lieu">
     3.11. Tài liệu
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="index_matplotlib.html">
   4. Matplotlib
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html">
     4.1. Format chung của một biểu đồ trên matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#cac-bieu-do-co-ban-tren-matplotlib">
     4.2. Các biểu đồ cơ bản trên matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#cac-bieu-do-nang-cao-tren-matplotlib">
     4.3. Các biểu đồ nâng cao trên matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#ve-nhieu-bieu-do-con-tren-mot-bieu-do">
     4.4. Vẽ nhiều biểu đồ con trên một biểu đồ
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#bieu-do-dong-tu-gif-file">
     4.5. Biểu đồ động từ gif file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#tong-ket">
     4.6. Tổng kết
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#bai-tap">
     4.7. Bài tập
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_matplotlib.html#tai-lieu-tham-khao">
     4.6. Tài liệu tham khảo
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="index_OOP.html">
   5. Lập trình hướng đối tượng (Object Oriented Programming - OOP)
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_OOP.html">
     5.1. Class và Object
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_OOP.html#tinh-ke-thua">
     5.2. Tính kế thừa
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_OOP.html#tong-ket">
     5.3. Tổng kết
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_OOP.html#bai-tap">
     5.4. Bài tập
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appendix_OOP.html#tai-lieu">
     5.5. Tài liệu
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Đại số tuyến tính
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_algebra/appendix_algebra.html">
   1. Đại số tuyến tính
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_algebra/appendix_algebra.html#tom-tat">
   2. Tóm tắt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_algebra/appendix_algebra.html#bai-tap">
   3. Bài tập
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Giải tích
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_calculus/appendix_calculus.html">
   1. Giải tích tích phân
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_calculus/appendix_calculus.html#giai-tich-vi-phan">
   2. Giải tích vi phân
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_calculus/appendix_calculus.html#bai-tap">
   3. Bài tập
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_calculus/appendix_calculus.html#tai-lieu-tham-khao">
   4. Tài liệu tham khảo
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Xác suất
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_probability/appendix_probability.html">
   1. Xác suất
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_probability/appendix_probability.html#phan-phoi-xac-suat">
   2. Phân phối xác suất
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_probability/appendix_probability.html#bai-tap">
   3. Bài tập
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_probability/appendix_probability.html#tai-lieu-tham-khao">
   4. Tài liệu tham khảo
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Đóng góp từ các tác giả khác
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_donation/fubini_and_riemann.html">
   Tích phân Riemann và định lý Fubini
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch_donation/information_theory.html">
   Lý thuyết thông tin
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/ch_appendix/appendix_pandas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ch_appendix/appendix_pandas.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/phamdinhkhanh/deepai-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/phamdinhkhanh/deepai-book/issues/new?title=Issue%20on%20page%20%2Fch_appendix/appendix_pandas.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/phamdinhkhanh/deepai-book/edit/main/book/ch_appendix/appendix_pandas.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/phamdinhkhanh/deepai-book/main?urlpath=tree/book/ch_appendix/appendix_pandas.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   2.1. Khởi tạo dataframe
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#khoi-tao-thong-qua-dictionary">
     2.1.1. Khởi tạo thông qua dictionary
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#khoi-tao-thong-qua-list-cac-dong">
     2.1.2. Khởi tạo thông qua list các dòng
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#doc-du-lieu-tu-file">
     2.1.3. Đọc dữ liệu từ file
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-to-csv-excel-txt-json">
     2.1.4. Export to CSV, EXCEL, TXT, JSON
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thao-tac-voi-dataframe">
   2.2. Thao tác với dataframe
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#truy-cap-dataframe">
     2.2.1. Truy cập dataframe
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loc-dataframe">
     2.2.2. Lọc dataframe
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sort-du-lieu">
     2.2.3. Sort dữ liệu
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cac-ham-doi-voi-mot-truong">
     2.2.4. Các hàm đối với một trường
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#min-max-mean-meadian-sum">
       2.2.4.1. Min, max, mean, meadian, sum
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ham-cut">
       2.2.4.2. Hàm cut
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ham-qcut">
       2.2.4.3. Hàm qcut
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#apply">
       2.2.4.4. Apply
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#map">
       2.2.4.5. Map
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bieu-do-matplotlib-tren-pandas">
     2.2.5. Biểu đồ matplotlib trên pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshape-dataframe-tren-pandas">
   2.3. Reshape dataframe trên pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#melt">
     2.3.1. Melt
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bien-doi-dummy">
     2.3.2. Biến đổi Dummy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thong-ke-theo-nhom-tren-pandas">
   2.4. Thống kê theo nhóm trên pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#df-groupby">
     2.4.1. df.groupby()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivotable">
     2.4.2. Pivotable
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#join-merge-va-concatenate-bang">
   2.5. Join, Merge và Concatenate bảng
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cac-kieu-join">
     2.5.1. Các kiểu join
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cau-lenh-pd-merge">
     2.5.2. Câu lệnh pd.merge()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#df-join">
     2.5.3. df.join()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cau-lenh-pd-concat">
     2.5.4. Câu lệnh pd.concat()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#append">
     2.5.5. append()
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ket-noi-sql">
   2.6. Kết nối SQL
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tong-ket">
   2.7. Tổng kết
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bai-tap">
   2.8. Bài tập
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tai-lieu">
   2.9. Tài liệu
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="khoi-tao-dataframe">
<h1>2.1. Khởi tạo dataframe<a class="headerlink" href="#khoi-tao-dataframe" title="Permalink to this headline">¶</a></h1>
<p>Đây là cách thường ít được áp dụng vì khi làm việc chúng ta thường đọc dữ liệu từ những file dữ liệu có sẵn được lưu dưới dạng <code class="docutils literal notranslate"><span class="pre">csv</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">txt</span></code>. Nhưng đôi khi chúng ta cũng cần khởi tạo dataframe từ đầu chẳng hạn như bạn muốn lưu kết quả log file của chương trình vào một dataframe và save dưới dạng <code class="docutils literal notranslate"><span class="pre">csv</span></code> sau đó. Việc lưu trữ dưới dạng dataframe sẽ giúp cho bạn dễ dàng thực hiện các phép lọc, thống kê và visualize trực tiếp từ dataframe một cách dễ dàng hơn.</p>
<p>Đưới đây mình sẽ giới thiệu hai cách khởi tạo dataframe chính trực tiếp từ câu lệnh <code class="docutils literal notranslate"><span class="pre">pd.DataFrame(.)</span></code>.</p>
<div class="section" id="khoi-tao-thong-qua-dictionary">
<h2>2.1.1. Khởi tạo thông qua dictionary<a class="headerlink" href="#khoi-tao-thong-qua-dictionary" title="Permalink to this headline">¶</a></h2>
<p>Về định dạng dictionary chúng ta đã được học ở <a class="reference external" href="https://phamdinhkhanh.github.io/deepai-book/ch_appendix/appendix_dtypes_basic.html#dictionary">chương phụ lục - dictionary</a>. Nội dung của dictionary sẽ gồm key là tên cột và value là list giá trị của cột tương ứng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_colwidth&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_rows&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_columns&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>


<span class="n">dict_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:[</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span> <span class="s1">&#39;Book&#39;</span><span class="p">,</span> <span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="s1">&#39;No_Donation&#39;</span><span class="p">],</span>
    <span class="s1">&#39;infos&#39;</span><span class="p">:[</span><span class="s1">&#39;Pham Dinh Khanh&#39;</span><span class="p">,</span> <span class="s1">&#39;ML algorithms to Practice&#39;</span><span class="p">,</span> <span class="s1">&#39;Vi mot cong dong AI vung manh hon&#39;</span><span class="p">,</span> <span class="s1">&#39;Community&#39;</span><span class="p">],</span>
    <span class="s1">&#39;numbers&#39;</span><span class="p">:[</span><span class="mi">1993</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict_columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>contents</th>
      <th>infos</th>
      <th>numbers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Author</td>
      <td>Pham Dinh Khanh</td>
      <td>1993</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Book</td>
      <td>ML algorithms to Practice</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Target</td>
      <td>Vi mot cong dong AI vung manh hon</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>No_Donation</td>
      <td>Community</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hàm display của <code class="docutils literal notranslate"><span class="pre">IPython</span></code> giúp cho DataFrame hiển thị được trên code khi run dưới dạng script file. các options của <code class="docutils literal notranslate"><span class="pre">pd.set_option()</span></code> lần lượt có tác dụng:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_colwidth</span></code>: Qui định chiều rộng tối đa của một cột.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code>: Độ chính xác của các sau dấu phảy của các cột định dạng float.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_columns</span></code>, <code class="docutils literal notranslate"><span class="pre">max_rows</span></code>: Lần lượt là độ số lượng cột và số lượng dòng tối đa được hiển thị.</p></li>
</ul>
<p>Tiếp theo chúng ta sẽ khởi tạo thông qua list các dòng.</p>
</div>
<div class="section" id="khoi-tao-thong-qua-list-cac-dong">
<h2>2.1.2. Khởi tạo thông qua list các dòng<a class="headerlink" href="#khoi-tao-thong-qua-list-cac-dong" title="Permalink to this headline">¶</a></h2>
<p>Theo cách này chúng ta sẽ truyền vào data là một list gồm các tupple mà mỗi tupple là một dòng dữ liệu. đối số <code class="docutils literal notranslate"><span class="pre">columns</span></code> sẽ qui định tên cột theo đúng thứ tự được qui định ở mỗi dòng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">records</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span> <span class="s1">&#39;Pham Dinh Khanh&#39;</span><span class="p">,</span> <span class="mi">1993</span><span class="p">),</span> 
           <span class="p">(</span><span class="s1">&#39;Book&#39;</span><span class="p">,</span> <span class="s1">&#39;ML algorithms to Practice&#39;</span><span class="p">,</span> <span class="mi">2021</span><span class="p">),</span> 
           <span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="s1">&#39;Vi mot cong dong AI vung manh hon&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
           <span class="p">(</span><span class="s1">&#39;No_Donation&#39;</span><span class="p">,</span> <span class="s1">&#39;Community&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
           
<span class="c1"># Khởi tạo DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">records</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">,</span> <span class="s1">&#39;infos&#39;</span><span class="p">,</span> <span class="s1">&#39;numbers&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>contents</th>
      <th>infos</th>
      <th>numbers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Author</td>
      <td>Pham Dinh Khanh</td>
      <td>1993</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Book</td>
      <td>ML algorithms to Practice</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Target</td>
      <td>Vi mot cong dong AI vung manh hon</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>No_Donation</td>
      <td>Community</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Để lưu trữ một dataframe dưới dạng một file <code class="docutils literal notranslate"><span class="pre">csv</span></code> chúng ta dùng hàm <code class="docutils literal notranslate"><span class="pre">.to_csv(.)</span></code> tham số truyền vào là đường link save file. Chẳng hạn bên dưới ta lưu dataframe vào một file “data.csv” cùng thư mục với file notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="doc-du-lieu-tu-file">
<h2>2.1.3. Đọc dữ liệu từ file<a class="headerlink" href="#doc-du-lieu-tu-file" title="Permalink to this headline">¶</a></h2>
<p>Chúng ta cũng có thể khởi tạo bảng bằng cách đọc file <code class="docutils literal notranslate"><span class="pre">csv,</span> <span class="pre">txt,</span> <span class="pre">xls,</span> <span class="pre">xlsx,</span> <span class="pre">dat</span></code> thông qua hàm <code class="docutils literal notranslate"><span class="pre">pd.read_csv(.)</span></code>. Hàm này không chỉ đọc được những file có trên máy tính của bạn mà còn có thể download những file có trên mạng. Bên dưới chúng ta thực hành đọc dữ liệu về giá nhà ở tại Boston từ bộ dữ liệu <code class="docutils literal notranslate"><span class="pre">BostonHousing</span></code>. Bộ dữ liệu này gồm các trường:</p>
<ul class="simple">
<li><p>crim: Tỷ lệ phạm tội phạm bình quân đầu người theo thị trấn.</p></li>
<li><p>zn: Tỷ lệ đất ở được quy hoạch cho các lô trên 25.000 foot square.</p></li>
<li><p>indus: Tỷ lệ diện tích thuộc lĩnh vực <em>kinh doanh phi bán lẻ</em> trên mỗi thị trấn.</p></li>
<li><p>chas: Biến giả, = 1 nếu được bao bởi sông Charles River, = 0 nếu ngược lại.</p></li>
<li><p>nox: Nồng độ khí Ni-tơ oxit.</p></li>
<li><p>rm: Trung bình số phòng trên một căn hộ.</p></li>
<li><p>age: Tỷ lệ căn hộ được xây dựng trước năm 1940.</p></li>
<li><p>dis: Khoảng cách trung bình có trọng số tới 5 trung tâm việc làm lớn nhất ở Boston.</p></li>
<li><p>rad: Chỉ số về khả năng tiếp cận đường cao tốc.</p></li>
<li><p>tax: Giá trị thuế suất tính trên đơn vị <code class="docutils literal notranslate"><span class="pre">10000$</span></code>.</p></li>
<li><p>ptratio: Tỷ lệ học sinh-giáo viên trên mỗi thị trấn.</p></li>
<li><p>black: Tỷ lệ số người da đen trong thị trấn được tính theo công thức:
<span class="math notranslate nohighlight">\(1000(\text{Bk} - 0.63)^2\)</span> ở đây <span class="math notranslate nohighlight">\(\text{Bk}\)</span> là tỷ lệ người da đen trong thị trấn.</p></li>
<li><p>lstat: Tỷ lệ phần trăm dân số thu nhập thấp.</p></li>
<li><p>medv: median giá trị của nhà có người sở hữu tính trên đơn vị <code class="docutils literal notranslate"><span class="pre">1000$</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/phamdinhkhanh/datasets/master/BostonHousing.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Trong hàm <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> chúng ta sẽ khai báo các thông số chính bao gồm :</p>
<ul class="simple">
<li><p>sep: Là viết tắt của seperator, ký hiệu ngăn cách các trường trong cùng một dòng, thường và mặc định là dấu phảy.</p></li>
<li><p>header: Mặc định là indice của dòng được chọn làm column name. Thường là dòng đầu tiên của file. Trường hợp file không có header thì để <code class="docutils literal notranslate"><span class="pre">header</span> <span class="pre">=</span> <span class="pre">None</span></code>. Khi đó indices cho column name sẽ được mặc định là các số tự nhiên liên tiếp từ 0 cho đến indice column cuối cùng.</p></li>
<li><p>index_col: Là indice của column được sử dụng làm giá trị index cho dataframe. cột index phải có giá trị khác nhau để phân biệt giữa các dòng và khi chúng ta để index_col = None thì giá trị index sẽ được đánh mặc định từ 0 cho đến dòng cuối cùng.</p></li>
</ul>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> mặc định sẽ hiển thị ra 5 quan sát đầu tiên của dataframe. Chúng ta muốn hiển thị 5 quan sát cuối cùng thì dùng hàm <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code> và 5 quan sát ngẫu nhiên thì dùng hàm <code class="docutils literal notranslate"><span class="pre">df.sample(5)</span></code>.</p>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">df.info()</span></code> sẽ cho ta biết định dạng và số lượng quan sát <code class="docutils literal notranslate"><span class="pre">not-null</span></code> của mỗi trường trong dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 506 entries, 0 to 505
Data columns (total 14 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   crim     506 non-null    float64
 1   zn       506 non-null    float64
 2   indus    506 non-null    float64
 3   chas     506 non-null    int64  
 4   nox      506 non-null    float64
 5   rm       506 non-null    float64
 6   age      506 non-null    float64
 7   dis      506 non-null    float64
 8   rad      506 non-null    int64  
 9   tax      506 non-null    int64  
 10  ptratio  506 non-null    float64
 11  b        506 non-null    float64
 12  lstat    506 non-null    float64
 13  medv     506 non-null    float64
dtypes: float64(11), int64(3)
memory usage: 55.5 KB
</pre></div>
</div>
</div>
</div>
<p>Hoặc chúng ta có thể dùng hàm <code class="docutils literal notranslate"><span class="pre">df.dtypes</span></code> để kiểm tra định dạng dữ liệu các trường của một bảng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for datatype</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>crim       float64
zn         float64
indus      float64
chas         int64
nox        float64
            ...   
tax          int64
ptratio    float64
b          float64
lstat      float64
medv       float64
Length: 14, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Nếu muốn kiểm tra chi tiết hơn những thống kê mô tả của dataframe như trung bình, phương sai, min, max, median của một trường dữ liệu chúng ta dùng hàm <code class="docutils literal notranslate"><span class="pre">df.describe()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Thống kê mô tả dữ liệu</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
      <td>506.00000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.61352</td>
      <td>11.36364</td>
      <td>11.13678</td>
      <td>0.06917</td>
      <td>0.55470</td>
      <td>6.28463</td>
      <td>68.57490</td>
      <td>3.79504</td>
      <td>9.54941</td>
      <td>408.23715</td>
      <td>18.45553</td>
      <td>356.67403</td>
      <td>12.65306</td>
      <td>22.53281</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.60155</td>
      <td>23.32245</td>
      <td>6.86035</td>
      <td>0.25399</td>
      <td>0.11588</td>
      <td>0.70262</td>
      <td>28.14886</td>
      <td>2.10571</td>
      <td>8.70726</td>
      <td>168.53712</td>
      <td>2.16495</td>
      <td>91.29486</td>
      <td>7.14106</td>
      <td>9.19710</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.00632</td>
      <td>0.00000</td>
      <td>0.46000</td>
      <td>0.00000</td>
      <td>0.38500</td>
      <td>3.56100</td>
      <td>2.90000</td>
      <td>1.12960</td>
      <td>1.00000</td>
      <td>187.00000</td>
      <td>12.60000</td>
      <td>0.32000</td>
      <td>1.73000</td>
      <td>5.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.08204</td>
      <td>0.00000</td>
      <td>5.19000</td>
      <td>0.00000</td>
      <td>0.44900</td>
      <td>5.88550</td>
      <td>45.02500</td>
      <td>2.10018</td>
      <td>4.00000</td>
      <td>279.00000</td>
      <td>17.40000</td>
      <td>375.37750</td>
      <td>6.95000</td>
      <td>17.02500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.25651</td>
      <td>0.00000</td>
      <td>9.69000</td>
      <td>0.00000</td>
      <td>0.53800</td>
      <td>6.20850</td>
      <td>77.50000</td>
      <td>3.20745</td>
      <td>5.00000</td>
      <td>330.00000</td>
      <td>19.05000</td>
      <td>391.44000</td>
      <td>11.36000</td>
      <td>21.20000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.67708</td>
      <td>12.50000</td>
      <td>18.10000</td>
      <td>0.00000</td>
      <td>0.62400</td>
      <td>6.62350</td>
      <td>94.07500</td>
      <td>5.18843</td>
      <td>24.00000</td>
      <td>666.00000</td>
      <td>20.20000</td>
      <td>396.22500</td>
      <td>16.95500</td>
      <td>25.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>88.97620</td>
      <td>100.00000</td>
      <td>27.74000</td>
      <td>1.00000</td>
      <td>0.87100</td>
      <td>8.78000</td>
      <td>100.00000</td>
      <td>12.12650</td>
      <td>24.00000</td>
      <td>711.00000</td>
      <td>22.00000</td>
      <td>396.90000</td>
      <td>37.97000</td>
      <td>50.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="export-to-csv-excel-txt-json">
<h2>2.1.4. Export to CSV, EXCEL, TXT, JSON<a class="headerlink" href="#export-to-csv-excel-txt-json" title="Permalink to this headline">¶</a></h2>
<p>Đây là câu lệnh được sử dụng khá phổ biến để lưu trữ các file dữ liệu từ dataframe sang những định dạng khác nhau. Những định dạng này sẽ cho phép chúng ta load lại dữ liệu bằng các hàm <code class="docutils literal notranslate"><span class="pre">read_csv(),</span> <span class="pre">read_xlsx(),</span> <span class="pre">read_txt(),</span> <span class="pre">read_json()</span></code> sau đó.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

# Lưu dữ liệu sang file csv
df.to_csv(&#39;BostonHousing.csv&#39;, index = False)
# Lưu file excel
df.to_excel(&#39;BostonHousing.xls&#39;, index = False)
# Lưu dữ file json
df.to_json(&#39;BostonHousing.json&#39;) #do not include index = False, index only use for table orient
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="thao-tac-voi-dataframe">
<h1>2.2. Thao tác với dataframe<a class="headerlink" href="#thao-tac-voi-dataframe" title="Permalink to this headline">¶</a></h1>
<div class="section" id="truy-cap-dataframe">
<h2>2.2.1. Truy cập dataframe<a class="headerlink" href="#truy-cap-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Chúng ta có thể truy cập dataframe theo hai cách.</p>
<p><strong>Truy cập theo slice index:</strong> Theo cách này chúng ta chỉ cần truyền vào index của dòng và cột và sử dụng hàm <code class="docutils literal notranslate"><span class="pre">df.iloc[rows_slice,</span> <span class="pre">columns_slice]</span></code> để trích xuất ra các dòng và cột tương ứng. Cách lấy slice cho rows và columns hoàn toàn tương tự như truy cập slice index trong <a class="reference external" href="https://phamdinhkhanh.github.io/deepai-book/ch_appendix/appendix_dtypes_basic.html#list">list</a>.</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">iloc</span></code> là viết tắt của indice location, tức là truy cập quan indice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lựa chọn 5 dòng đầu và 5 cột đầu của df</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lựa chọn 5 dòng từ 5:10 và 2 cột từ 2:4</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>indus</th>
      <th>chas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>2.18</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.87</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.87</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7.87</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.87</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lựa chọn 5 dòng cuối và các cột 1 và 3</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>zn</th>
      <th>chas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>501</th>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>502</th>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>503</th>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>504</th>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>505</th>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ngoài ra ta cũng có thể truy cập các dòng theo row index của dataframe thông qua câu lệnh <code class="docutils literal notranslate"><span class="pre">df.loc[]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Truy cập các dòng có index là 10:15</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>0.22489</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.377</td>
      <td>94.3</td>
      <td>6.3467</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>392.52</td>
      <td>20.45</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.11747</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.009</td>
      <td>82.9</td>
      <td>6.2267</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>396.90</td>
      <td>13.27</td>
      <td>18.9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.09378</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>5.889</td>
      <td>39.0</td>
      <td>5.4509</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>390.50</td>
      <td>15.71</td>
      <td>21.7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.62976</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>5.949</td>
      <td>61.8</td>
      <td>4.7075</td>
      <td>4</td>
      <td>307</td>
      <td>21.0</td>
      <td>396.90</td>
      <td>8.26</td>
      <td>20.4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.63796</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.096</td>
      <td>84.5</td>
      <td>4.4619</td>
      <td>4</td>
      <td>307</td>
      <td>21.0</td>
      <td>380.02</td>
      <td>10.26</td>
      <td>18.2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.62739</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>5.834</td>
      <td>56.5</td>
      <td>4.4986</td>
      <td>4</td>
      <td>307</td>
      <td>21.0</td>
      <td>395.62</td>
      <td>8.47</td>
      <td>19.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Truy cập theo column names:</strong> Đây là cách được sử dụng phổ biến vì nó tường minh hơn. Theo cách này chúng ta sẽ truy cập các trường của dataframe bằng cách khai báo list column_names của chúng.</p>
<p>Ví dụ bên dưới chúng ta cần lấy ra các trường <code class="docutils literal notranslate"><span class="pre">['crim',</span> <span class="pre">'tax',</span> <span class="pre">'rad']</span></code> từ bảng <code class="docutils literal notranslate"><span class="pre">df</span></code>. Ta sẽ làm như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;crim&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;rad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>tax</th>
      <th>rad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>296</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>242</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>242</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>222</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>222</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Kết hợp cả hai cách</strong>: Chúng ta có thể truy cập dataframe bằng cách kết hợp cả hai cách theo hướng sử dụng column names đối với cột và slice index đối với dòng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lấy ra các dòng từ 10:15 của các trường &#39;crim&#39;, &#39;tax&#39;, &#39;rad&#39;</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;crim&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;rad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>tax</th>
      <th>rad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>0.22489</td>
      <td>311</td>
      <td>5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.11747</td>
      <td>311</td>
      <td>5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.09378</td>
      <td>311</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.62976</td>
      <td>307</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.63796</td>
      <td>307</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="loc-dataframe">
<h2>2.2.2. Lọc dataframe<a class="headerlink" href="#loc-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Chúng ta có thể lọc dataframe thông qua các điều kiện đối với các trường. Điều kiện của trường được thể hiện như một biểu thức logic và bao trong dấu <code class="docutils literal notranslate"><span class="pre">[]</span></code>. Giả sử chúng ta muốn lọc ra các thị trấn mà có số phòng ở trung bình trên căn hộ là trên 4 thì truyền vào dấu <code class="docutils literal notranslate"><span class="pre">[]</span></code> điều kiện <code class="docutils literal notranslate"><span class="pre">df['rm']</span> <span class="pre">&gt;</span> <span class="pre">4</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rm&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nếu chúng ta muốn kết hợp nhiều điều kiện thì dùng biểu thức logic <code class="docutils literal notranslate"><span class="pre">and</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">or</span></code>. Ví dụ: Muốn lọc thêm điều kiện thuế suất trên 250 ngoài điều kiện số phòng thì ta làm như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rm&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">250</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.08829</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.012</td>
      <td>66.6</td>
      <td>5.5605</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>395.60</td>
      <td>12.43</td>
      <td>22.9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.14455</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.172</td>
      <td>96.1</td>
      <td>5.9505</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>396.90</td>
      <td>19.15</td>
      <td>27.1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.21124</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>5.631</td>
      <td>100.0</td>
      <td>6.0821</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>386.63</td>
      <td>29.93</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.17004</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.004</td>
      <td>85.9</td>
      <td>6.5921</td>
      <td>5</td>
      <td>311</td>
      <td>15.2</td>
      <td>386.71</td>
      <td>17.10</td>
      <td>18.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Muốn lọc các cột theo định dạng dữ liệu thì như thế nào?</strong></p>
<p>Ta dùng hàm <code class="docutils literal notranslate"><span class="pre">df.select_dtypes()</span></code> để lọc các cột theo định dạng dữ liệu. Những định dạng chính bao gồm <code class="docutils literal notranslate"><span class="pre">integer,</span> <span class="pre">float,</span> <span class="pre">object,</span> <span class="pre">boolean</span></code>. Ví dụ: Bên dưới chúng ta lọc các trường có định dạng dữ liệu là <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Lọc các cột theo pattern của tên cột</strong></p>
<p>Khi làm việc với dữ liệu lớn sẽ có những tình huống mà bạn bắt gặp các cột thuộc về cùng một nhóm và chúng có chung một pattern. Chẳng hạn như về age sẽ có <code class="docutils literal notranslate"><span class="pre">age_1,</span> <span class="pre">age_2,</span> <span class="pre">age_3</span></code>,… Làm thế nào để bạn lọc ra được những biến này từ dữ liệu? Chúng ta sẽ dùng hàm filter. Đây là hàm cực kỳ tiện ích khi lọc cột từ những bộ dữ liệu lớn mà bạn sẽ thường xuyên sử dụng sau này.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
    <span class="s1">&#39;age_1&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;age_2&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;age_3&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age_1</th>
      <th>age_2</th>
      <th>age_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>3</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e</td>
      <td>5</td>
      <td>10</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Lựa chọn các cột bắt đầu là <code class="docutils literal notranslate"><span class="pre">age</span></code> thông qua hàm filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;^age&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age_1</th>
      <th>age_2</th>
      <th>age_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>10</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Trong pandas thì <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> là làm việc với cột và <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> là làm việc với dòng. Giá trị của <code class="docutils literal notranslate"><span class="pre">regex=^age</span></code> có nghĩa là lọc các cột có chuỗi ký tự là <code class="docutils literal notranslate"><span class="pre">age</span></code> đứng đầu.</p>
</div>
<div class="section" id="sort-du-lieu">
<h2>2.2.3. Sort dữ liệu<a class="headerlink" href="#sort-du-lieu" title="Permalink to this headline">¶</a></h2>
<p>Trong nhiều trường hợp bạn sẽ cần sort dữ liệu theo chiều từ thấp lên cao hoặc từ cao xuống thấp để biết đâu là những quan sát nhỏ nhất và lớn nhất cũng như việc tạo ra một đồ thị có trend rõ ràng và thể hiện quan hệ tuyến tính giữa các biến theo trend.</p>
<p>Để sort dữ liệu chúng ta sử dụng hàm <code class="docutils literal notranslate"><span class="pre">df.sort_values(.)</span></code>. Lựa chọn là <code class="docutils literal notranslate"><span class="pre">ascending</span> <span class="pre">=</span> <span class="pre">True</span></code> giúp sort theo thứ tự tăng dần, trường hợp <code class="docutils literal notranslate"><span class="pre">False</span></code> sẽ giảm dần.</p>
<p>Giả sử bên dưới chúng ta cùng sort giá trị của căn nhà theo chiều giảm dần.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Sort data</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;medv&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>283</th>
      <td>0.01501</td>
      <td>90.0</td>
      <td>1.21</td>
      <td>1</td>
      <td>0.401</td>
      <td>7.923</td>
      <td>24.8</td>
      <td>5.8850</td>
      <td>1</td>
      <td>198</td>
      <td>13.6</td>
      <td>395.52</td>
      <td>3.16</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>225</th>
      <td>0.52693</td>
      <td>0.0</td>
      <td>6.20</td>
      <td>0</td>
      <td>0.504</td>
      <td>8.725</td>
      <td>83.0</td>
      <td>2.8944</td>
      <td>8</td>
      <td>307</td>
      <td>17.4</td>
      <td>382.00</td>
      <td>4.63</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>369</th>
      <td>5.66998</td>
      <td>0.0</td>
      <td>18.10</td>
      <td>1</td>
      <td>0.631</td>
      <td>6.683</td>
      <td>96.8</td>
      <td>1.3567</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>375.33</td>
      <td>3.73</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>370</th>
      <td>6.53876</td>
      <td>0.0</td>
      <td>18.10</td>
      <td>1</td>
      <td>0.631</td>
      <td>7.016</td>
      <td>97.5</td>
      <td>1.2024</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>392.05</td>
      <td>2.96</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>371</th>
      <td>9.23230</td>
      <td>0.0</td>
      <td>18.10</td>
      <td>0</td>
      <td>0.631</td>
      <td>6.216</td>
      <td>100.0</td>
      <td>1.1691</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>366.15</td>
      <td>9.53</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>chúng ta cũng có thể sort theo một nhóm các trường. Ví dụ để sort đồng thời giá trị của căn nhà và giá trị thuế suất thì ta truyền vào list các trường cần sort là <code class="docutils literal notranslate"><span class="pre">['medv',</span> <span class="pre">'tax']</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;medv&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>368</th>
      <td>4.89822</td>
      <td>0.0</td>
      <td>18.1</td>
      <td>0</td>
      <td>0.631</td>
      <td>4.970</td>
      <td>100.0</td>
      <td>1.3325</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>375.52</td>
      <td>3.26</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>369</th>
      <td>5.66998</td>
      <td>0.0</td>
      <td>18.1</td>
      <td>1</td>
      <td>0.631</td>
      <td>6.683</td>
      <td>96.8</td>
      <td>1.3567</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>375.33</td>
      <td>3.73</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>370</th>
      <td>6.53876</td>
      <td>0.0</td>
      <td>18.1</td>
      <td>1</td>
      <td>0.631</td>
      <td>7.016</td>
      <td>97.5</td>
      <td>1.2024</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>392.05</td>
      <td>2.96</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>371</th>
      <td>9.23230</td>
      <td>0.0</td>
      <td>18.1</td>
      <td>0</td>
      <td>0.631</td>
      <td>6.216</td>
      <td>100.0</td>
      <td>1.1691</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>366.15</td>
      <td>9.53</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>372</th>
      <td>8.26725</td>
      <td>0.0</td>
      <td>18.1</td>
      <td>1</td>
      <td>0.668</td>
      <td>5.875</td>
      <td>89.6</td>
      <td>1.1296</td>
      <td>24</td>
      <td>666</td>
      <td>20.2</td>
      <td>347.88</td>
      <td>8.88</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="cac-ham-doi-voi-mot-truong">
<h2>2.2.4. Các hàm đối với một trường<a class="headerlink" href="#cac-ham-doi-voi-mot-truong" title="Permalink to this headline">¶</a></h2>
<div class="section" id="min-max-mean-meadian-sum">
<h3>2.2.4.1. Min, max, mean, meadian, sum<a class="headerlink" href="#min-max-mean-meadian-sum" title="Permalink to this headline">¶</a></h3>
<p>Trên một trường dữ liệu của dataframe đã tích hợp sẵn các hàm tính toán như <code class="docutils literal notranslate"><span class="pre">min,</span> <span class="pre">max,</span> <span class="pre">mean,</span> <span class="pre">median,</span> <span class="pre">sum</span></code> để tính các giá trị đặc trưng cho từng trường.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># min, max, mean, median, sum</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>187 711 408.2371541501976 330.0 206568
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ham-cut">
<h3>2.2.4.2. Hàm cut<a class="headerlink" href="#ham-cut" title="Permalink to this headline">¶</a></h3>
<p>Hàm cut giúp ta phân chia giá trị của một trường liên tục vào những khoảng theo ngưỡng cắt. Kết quả trả ra là nhãn của từng khoảng mà chúng ta khai báo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">999999</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">999999</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">]</span>
<span class="c1"># low: -999999 &lt;- 250</span>
<span class="c1"># normal: 250 &lt;- 400</span>
<span class="c1"># high: 400 &lt;- 999999</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;high&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>b</th>
      <th>lstat</th>
      <th>medv</th>
      <th>tax_labels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>0.01360</td>
      <td>75.0</td>
      <td>4.00</td>
      <td>0</td>
      <td>0.410</td>
      <td>5.888</td>
      <td>47.6</td>
      <td>7.3197</td>
      <td>3</td>
      <td>469</td>
      <td>21.1</td>
      <td>396.90</td>
      <td>14.80</td>
      <td>18.9</td>
      <td>high</td>
    </tr>
    <tr>
      <th>111</th>
      <td>0.10084</td>
      <td>0.0</td>
      <td>10.01</td>
      <td>0</td>
      <td>0.547</td>
      <td>6.715</td>
      <td>81.6</td>
      <td>2.6775</td>
      <td>6</td>
      <td>432</td>
      <td>17.8</td>
      <td>395.59</td>
      <td>10.16</td>
      <td>22.8</td>
      <td>high</td>
    </tr>
    <tr>
      <th>112</th>
      <td>0.12329</td>
      <td>0.0</td>
      <td>10.01</td>
      <td>0</td>
      <td>0.547</td>
      <td>5.913</td>
      <td>92.9</td>
      <td>2.3534</td>
      <td>6</td>
      <td>432</td>
      <td>17.8</td>
      <td>394.95</td>
      <td>16.21</td>
      <td>18.8</td>
      <td>high</td>
    </tr>
    <tr>
      <th>113</th>
      <td>0.22212</td>
      <td>0.0</td>
      <td>10.01</td>
      <td>0</td>
      <td>0.547</td>
      <td>6.092</td>
      <td>95.4</td>
      <td>2.5480</td>
      <td>6</td>
      <td>432</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>17.09</td>
      <td>18.7</td>
      <td>high</td>
    </tr>
    <tr>
      <th>114</th>
      <td>0.14231</td>
      <td>0.0</td>
      <td>10.01</td>
      <td>0</td>
      <td>0.547</td>
      <td>6.254</td>
      <td>84.2</td>
      <td>2.2565</td>
      <td>6</td>
      <td>432</td>
      <td>17.8</td>
      <td>388.74</td>
      <td>10.45</td>
      <td>18.5</td>
      <td>high</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ham-qcut">
<h3>2.2.4.3. Hàm qcut<a class="headerlink" href="#ham-qcut" title="Permalink to this headline">¶</a></h3>
<p>Trong trường hợp chúng ta không muốn chia các bin dựa vào ngưỡng mà chỉ muốn khai báo số lượng bins và để cho hàm số tự quyết định ngưỡng để chia đều các quan sát vào các bins thì sử dụng hàm <code class="docutils literal notranslate"><span class="pre">pd.qcut(.)</span></code> (qcut là viết tắt của quantile cut). Bên dưới ta sẽ chia thành 3 bins (số bins sẽ được khai báo trong <code class="docutils literal notranslate"><span class="pre">q=3</span></code>) với labels tương ứng là <code class="docutils literal notranslate"><span class="pre">['low',</span> <span class="pre">'normal',</span> <span class="pre">'high']</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">]</span>
<span class="n">tax_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tax_labels</span><span class="p">,</span> <span class="n">return_counts</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([&#39;high&#39;, &#39;low&#39;, &#39;normal&#39;], dtype=object), array([168, 172, 166]))
</pre></div>
</div>
</div>
</div>
<p>Trường hợp muốn xác định tỷ lệ phần trăm <strong>luỹ kế</strong> của các ngưỡng phân chia ta có thể khai báo q là list gồm các ngưỡng luỹ kế. Ví dụ bên dưới ta muốn chia làm ba khoảng giá trị, mỗi khoảng chiếm 33% thì ta khai báo ngưỡng luỹ kế <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">=</span> <span class="pre">[0,</span> <span class="pre">0.33,</span> <span class="pre">0.66,</span> <span class="pre">1]</span></code></p>
</div>
<div class="section" id="apply">
<h3>2.2.4.4. Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p>Apply sẽ giúp ta biến đổi giá trị của một trường theo một hàm số xác định trước. Hàm số biến đổi được áp dụng trong apply sẽ là một hàm <code class="docutils literal notranslate"><span class="pre">lamda</span></code>. Hàm lambda là một khái niệm rất quan trọng trong python, hàm số này có cú pháp dạng <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">formula</span></code>.</p>
<p>Phân tích kỹ hơn thì chúng ta thấy nó không có return. Điều này là phù hợp với ý nghĩa của hàm lambda vì nó không yêu cầu gía trị trả về ngay. Thực tế nó giống như một lời hứa sẽ thực hiện hàm đó tại thời điểm áp dụng một cách ngầm định bên trong một hàm khác (ở đây là hàm apply).</p>
<p>Ví dụ bên dưới ta muốn nhân đôi giá trị của tax thì có thể sử dụng hàm apply với lambda như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    592
1    484
2    484
3    444
4    444
Name: tax, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Ta cũng có thể áp dụng cho nhiều trường một lúc. Khi đó cần khai báo <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> để biết rằng ta đang áp dụng trên từng cột, nếu axis=0 thì sẽ áp dụng trên từng dòng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;medv&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tax</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>592.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>484.0</td>
      <td>43.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>484.0</td>
      <td>69.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>444.0</td>
      <td>66.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>444.0</td>
      <td>72.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="map">
<h3>2.2.4.5. Map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h3>
<p>Map là hàm giúp biến đổi giá trị của một biến sang giá trị mới dựa trên dictionary mà chúng ta áp dụng. Giá trị cũ sẽ là key và giá trị mới sẽ là value.</p>
<p>Bên dưới ta sẽ map các giá trị của trường <code class="docutils literal notranslate"><span class="pre">df['tax_labels']</span></code> sang các giá trị tiếng Việt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dict_tax</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;low&#39;</span><span class="p">:</span><span class="s1">&#39;thap&#39;</span><span class="p">,</span>
      <span class="s1">&#39;normal&#39;</span><span class="p">:</span><span class="s1">&#39;tb&#39;</span><span class="p">,</span>        
      <span class="s1">&#39;high&#39;</span><span class="p">:</span><span class="s1">&#39;cao&#39;</span>
    <span class="p">}</span>
    
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dict_tax</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      tb
1    thap
2    thap
3    thap
4    thap
Name: tax_labels, dtype: category
Categories (3, object): [&#39;thap&#39; &lt; &#39;tb&#39; &lt; &#39;cao&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bieu-do-matplotlib-tren-pandas">
<h2>2.2.5. Biểu đồ matplotlib trên pandas<a class="headerlink" href="#bieu-do-matplotlib-tren-pandas" title="Permalink to this headline">¶</a></h2>
<p>Chúng ta có thể nói rằng pandas rất mạnh vì nó đã wrap dường như toàn bộ các đồ thị cơ bản của matplotlib vào bên trong các hàm thành phần của pandas column. Do đó việc visualize trở nên vô cùng ngắn gọn, thậm chí là chỉ trên một dòng.</p>
<p>Bên dưới chúng ta sẽ cùng lướt qua nhanh các đồ thị cơ bản khi visualize trên <code class="docutils literal notranslate"><span class="pre">pd.column</span></code>. Biến được áp dụng đồng nhất cho các đồ thị là <code class="docutils literal notranslate"><span class="pre">tax</span></code>.</p>
<p><strong>1. biểu đồ line</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff689ac4cc0&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_60_1.png" src="../_images/appendix_pandas_60_1.png" />
</div>
</div>
<p><strong>2. Biểu đồ line kết hợp với point</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff68858b198&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_62_1.png" src="../_images/appendix_pandas_62_1.png" />
</div>
</div>
<p><strong>3. Biểu đồ barchart</strong></p>
<p>Biều đồ này được dùng phù hợp khi chúng ta muốn so sánh chênh lệch giữa các nhóm về mặt giá trị tuyệt đối.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_summary</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df_summary</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff6882f24e0&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_64_1.png" src="../_images/appendix_pandas_64_1.png" />
</div>
</div>
<p>Ở đây ta sẽ phải dùng thêm hàm groupby để tạo thành bảng thống kê tổng thuế theo <code class="docutils literal notranslate"><span class="pre">tax_labels</span></code> rồi mới vẽ biểu đồ. Khi quen thuộc bạn có thể viết gọn hai câu lệnh lại thành một line như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff663d64e10&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_66_1.png" src="../_images/appendix_pandas_66_1.png" />
</div>
</div>
<p><strong>4. Biểu đồ pie</strong></p>
<p>Đây là biểu đồ dùng để thể hiện giá trị phần trăm. Phù hợp khi so sánh giá trị tương đối giữa các nhóm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_summary</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff6882e09e8&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_68_1.png" src="../_images/appendix_pandas_68_1.png" />
</div>
</div>
<p><strong>5. Biểu đồ boxplot</strong></p>
<p>Biểu đồ boxplot sẽ được sử dụng để quan sát phân phối của biến đối với các giá trị min, max và các ngưỡng phân vị 25%, 50%, 75%. Căn cứ vào boxplot ta có thể biết được khoảng biến thiên của biến rộng hay hẹp, biến phân phối lệch trái hay phải.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff663ca3208&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_70_1.png" src="../_images/appendix_pandas_70_1.png" />
</div>
</div>
<p><strong>6. Biểu đồ area</strong></p>
<p>Biểu đồ area cho ta biết diện tích nằm dưới đường biểu diễn và trên trục hoành.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_summary</span><span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff663c32518&gt;
</pre></div>
</div>
<img alt="../_images/appendix_pandas_72_1.png" src="../_images/appendix_pandas_72_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="reshape-dataframe-tren-pandas">
<h1>2.3. Reshape dataframe trên pandas<a class="headerlink" href="#reshape-dataframe-tren-pandas" title="Permalink to this headline">¶</a></h1>
<div class="section" id="melt">
<h2>2.3.1. Melt<a class="headerlink" href="#melt" title="Permalink to this headline">¶</a></h2>
<p>Hàm melt là hàm được lấy ý tưởng từ ngôn ngữ R. Hàm này sẽ làm cho bảng của chúng ta trở nên bớt cồng kềnh hơn bằng cách rút gọn nhiều measurements thành hai cột variable và value trong đó cột variable qui định loại measurement và value là giá trị của measurement. Bảng của bạn sẽ có ít cột hơn đáng kể nên trông giống như các cột measurement đang bị tan chảy vậy. Do đó nó có tên gọi là melt.</p>
<p>Bạn sẽ dễ hình dung hơn những gì mình nói thông qua ví dụ bên dưới. Giả sử bảng của mình gồm Ho, Ten là các dimensions và <code class="docutils literal notranslate"><span class="pre">ChieuCao,</span> <span class="pre">CanNang,</span> <span class="pre">Tuoi,</span> <span class="pre">Diem</span></code> là những measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
  <span class="s1">&#39;Ho&#39;</span><span class="p">:[</span><span class="s1">&#39;Pham&#39;</span><span class="p">,</span><span class="s1">&#39;Nguyen&#39;</span><span class="p">],</span>
  <span class="s1">&#39;Ten&#39;</span> <span class="p">:[</span><span class="s1">&#39;Cong&#39;</span><span class="p">,</span> <span class="s1">&#39;Dong&#39;</span><span class="p">],</span>
  <span class="s1">&#39;ChieuCao&#39;</span><span class="p">:[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
  <span class="s1">&#39;CanNang&#39;</span><span class="p">:[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">],</span>
  <span class="s1">&#39;Tuoi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span>
  <span class="s1">&#39;Diem&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.5</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">],</span>
<span class="p">})</span>

<span class="n">df5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ho</th>
      <th>Ten</th>
      <th>ChieuCao</th>
      <th>CanNang</th>
      <th>Tuoi</th>
      <th>Diem</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pham</td>
      <td>Cong</td>
      <td>170</td>
      <td>60</td>
      <td>25</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nguyen</td>
      <td>Dong</td>
      <td>175</td>
      <td>65</td>
      <td>27</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ta nhận thấy <code class="docutils literal notranslate"><span class="pre">Ho,</span> <span class="pre">Ten</span></code> là những dimension, bây giờ ta sẽ giữ nguyên những trường này và làm tan chảy các cột.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span><span class="o">.</span><span class="n">melt</span><span class="p">([</span><span class="s1">&#39;Ho&#39;</span><span class="p">,</span> <span class="s1">&#39;Ten&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ho</th>
      <th>Ten</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pham</td>
      <td>Cong</td>
      <td>ChieuCao</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nguyen</td>
      <td>Dong</td>
      <td>ChieuCao</td>
      <td>175.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Pham</td>
      <td>Cong</td>
      <td>CanNang</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nguyen</td>
      <td>Dong</td>
      <td>CanNang</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pham</td>
      <td>Cong</td>
      <td>Tuoi</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Nguyen</td>
      <td>Dong</td>
      <td>Tuoi</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Pham</td>
      <td>Cong</td>
      <td>Diem</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Nguyen</td>
      <td>Dong</td>
      <td>Diem</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ta nhận thấy bảng đã trở nên gọn gàng hơn khi các cột được đưa vào trường <code class="docutils literal notranslate"><span class="pre">variable</span></code> và giá trị của chúng được đưa vào <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<p>Cách biến đổi <code class="docutils literal notranslate"><span class="pre">melt</span></code> sẽ phù hợp với các bảng đã phân chia sẵn dimension, measurement rõ ràng và số lượng measurements của bảng là lớn.</p>
</div>
<div class="section" id="bien-doi-dummy">
<h2>2.3.2. Biến đổi Dummy<a class="headerlink" href="#bien-doi-dummy" title="Permalink to this headline">¶</a></h2>
<p>Cách biến đổi dummy là một cách rất hiệu quả để biến đổi một biến category thành một one-hot véc tơ. Cụ thể cũng với bảng <code class="docutils literal notranslate"><span class="pre">df5</span></code> ở trên, ta nhận thấy biến <code class="docutils literal notranslate"><span class="pre">Ho</span></code> gồm hai giá trị là <code class="docutils literal notranslate"><span class="pre">Pham</span></code> và <code class="docutils literal notranslate"><span class="pre">Nguyen</span></code>. Chúng ta có thể tạo thành một one-hot vector sao cho nếu giá trị đầu tiên là 1 thì tương ứng với họ <code class="docutils literal notranslate"><span class="pre">Pham</span></code> và giá trị thứ hai là 1 thì họ <code class="docutils literal notranslate"><span class="pre">Nguyen</span></code> (chưa xét tới trường hợp tồn tại họ khác <code class="docutils literal notranslate"><span class="pre">Pham</span></code> và <code class="docutils literal notranslate"><span class="pre">Nguyen</span></code>). Thường thì bạn sẽ nghĩ đến sử dụng hàm <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html">LabelBinarizer</a> của sklearn nhưng pandas cung cấp cho bạn một hàm đơn giản hơn để thực hiện việc này. Đó là <code class="docutils literal notranslate"><span class="pre">pd.get_dummies()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ChieuCao</th>
      <th>CanNang</th>
      <th>Tuoi</th>
      <th>Diem</th>
      <th>Ho_Nguyen</th>
      <th>Ho_Pham</th>
      <th>Ten_Cong</th>
      <th>Ten_Dong</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>170</td>
      <td>60</td>
      <td>25</td>
      <td>8.5</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>175</td>
      <td>65</td>
      <td>27</td>
      <td>9.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ta thấy hàm này sẽ tìm <strong>toàn bộ</strong> các biến là category (có định dạng trường là <code class="docutils literal notranslate"><span class="pre">object</span></code>) và tự động trải phẳng chúng. Khi đó các cột mới được tạo thành chính là <code class="docutils literal notranslate"><span class="pre">Ho_Nguyen</span></code>, <code class="docutils literal notranslate"><span class="pre">Ho_Pham</span></code> là những nhãn thuộc biến <code class="docutils literal notranslate"><span class="pre">Ho</span></code>. Giá trị của những trường này bằng 0 hoặc 1.</p>
<p>Mặc dù có cú pháp cực kì đơn giản nhưng hàm <code class="docutils literal notranslate"><span class="pre">pd.get_dummies()</span></code> lại cực kì hữu ích đối với data scientist khi xây dựng mô hình mà bạn cần ghi nhớ.</p>
</div>
</div>
<div class="section" id="thong-ke-theo-nhom-tren-pandas">
<h1>2.4. Thống kê theo nhóm trên pandas<a class="headerlink" href="#thong-ke-theo-nhom-tren-pandas" title="Permalink to this headline">¶</a></h1>
<p>Khi làm việc với dữ liệu bảng chúng ta thường xuyên phải thống kê dữ liệu theo các nhóm để bắt dữ liệu tạo ra những thông tin insight hữu ích cho phân tích và ra quyết định. Ngoài ra những feature tốt, có sức mạnh phân loại và dự báo cao có thể được tạo thành từ việc thống kê dữ liệu theo nhóm. Quá trình thống kê và phân tích dữ liệu mặc dù tốn kém về mặt thời gian nhưng lại rất quan trọng đối với mô hình. Vì vậy chúng ta cần thực hiện chúng kỹ lưỡng và cần kết hợp giữa kỹ năng thống kê và kinh nghiệm thực tiễn.</p>
<p>Ở mục 5 này chúng ta sẽ làm quen với hai câu lệnh kinh điển trong pandas được sử dụng nhiều trong thống kê theo nhóm trên pandas đó là <code class="docutils literal notranslate"><span class="pre">df.groupby()</span></code> và <code class="docutils literal notranslate"><span class="pre">pd.pivotable()</span></code>.</p>
<div class="section" id="df-groupby">
<h2>2.4.1. df.groupby()<a class="headerlink" href="#df-groupby" title="Permalink to this headline">¶</a></h2>
<p>groupby là câu lệnh cho phép bạn áp dụng những hàm số trên measurements dựa trên việc phân nhóm dữ liệu theo các dimensions.</p>
<p>Nếu bạn chưa hiểu về khái niệm measurement và dimension thì mình có thể giải thích đơn giản là: measurement là những biến có thể cộng trừ nhân chia và đo đếm được còn dimension là những biến dùng để phân nhóm dữ liệu. Ví dụ chiều cao là một measurement có thể đo theo dimension là giới tính gồm các nhóm nam/nữ.</p>
<p>Cú pháp của hàm <code class="docutils literal notranslate"><span class="pre">df.groupby()</span></code> khá đơn giản:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
  <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Chúng ta cần xác định các chiều dimension trong <code class="docutils literal notranslate"><span class="pre">by</span></code>. Phía sau <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> là một list các measurements mà ta cần áp dụng hàm lên trên những trường này.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tax_labels
low        15221
normal     73540
high      117807
Name: tax, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Theo cách trên thì ta chỉ áp dụng được với những hàm tính toán như <code class="docutils literal notranslate"><span class="pre">sum,</span> <span class="pre">avg,</span> <span class="pre">min,</span> <span class="pre">max</span></code> có sẵn trong dataframe. Nếu muốn sử dụng <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> cho mọi biến đổi hàm chúng ta có thể dùng hàm <code class="docutils literal notranslate"><span class="pre">lambda</span></code> trong <code class="docutils literal notranslate"><span class="pre">apply()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tax_labels
low        15221
normal     73540
high      117807
Name: tax, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Nếu muốn áp dụng tính toán cho nhiều measurements một lúc thì truyền vào một list các measurements. Chẳng hạn bên dưới ta truyền vào một list gồm <code class="docutils literal notranslate"><span class="pre">['tax',</span> <span class="pre">'rm']</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)[[</span><span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;rm&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tax</th>
      <th>rm</th>
    </tr>
    <tr>
      <th>tax_labels</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>low</th>
      <td>220.59420</td>
      <td>6.52564</td>
    </tr>
    <tr>
      <th>normal</th>
      <td>310.29536</td>
      <td>6.42074</td>
    </tr>
    <tr>
      <th>high</th>
      <td>589.03500</td>
      <td>6.04020</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Chúng ta cũng có thể tự định nghĩa các hàm được tuỳ biến theo ý muốn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tính quantile 90% của mỗi nhóm tax_labels.</span>
<span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="n">q_90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">q_90</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">)[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tax_labels
low       244.2
normal    384.0
high      666.0
Name: tax, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Hoặc group theo nhiều chiều dữ liệu. Khi đó phải truyền vào <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> một list các dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;chas&#39;</span><span class="p">])[</span><span class="s1">&#39;tax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tax_labels  chas
low         0       244.6
            1       223.0
normal      0       384.0
            1       307.0
high        0       666.0
            1       666.0
Name: tax, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Ưu điểm của <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> đó là nhanh gọn, dễ hiểu. Nhưng nhược điểm của <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> đó là chúng ta chỉ có thể áp dụng cùng một biến đổi hàm số cho mọi measurements. Ở <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> bạn có thể tuỳ biến sâu hơn từng hàm đối với từng measurement nhưng cú pháp sẽ phức tạp hơn một chút.</p>
</div>
<div class="section" id="pivotable">
<h2>2.4.2. Pivotable<a class="headerlink" href="#pivotable" title="Permalink to this headline">¶</a></h2>
<p>Pivot table là một công thức có ứng dụng rất quan trọng trong pandas. Nó giúp cho chúng ta thực hiện các thống kê trên các biến measurement theo các chiều dimension.</p>
<p>Bạn sẽ hình dung ra cách áp dụng của <code class="docutils literal notranslate"><span class="pre">pivot_table()</span></code> thông qua ví dụ bên dưới.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> 
               <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;chas&#39;</span><span class="p">],</span> 
               <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">],</span> 
               <span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;tax&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>tax_labels</th>
      <th colspan="2" halign="left">low</th>
      <th colspan="2" halign="left">normal</th>
      <th colspan="2" halign="left">high</th>
    </tr>
    <tr>
      <th>chas</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>rad</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>241.0</td>
      <td>198.0</td>
      <td>4968.0</td>
      <td>NaN</td>
      <td>422.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1800.0</td>
      <td>NaN</td>
      <td>4456.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6424.0</td>
      <td>446.0</td>
      <td>1208.0</td>
      <td>NaN</td>
      <td>1273.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2155.0</td>
      <td>NaN</td>
      <td>20434.0</td>
      <td>2147.0</td>
      <td>12222.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2853.0</td>
      <td>216.0</td>
      <td>22175.0</td>
      <td>828.0</td>
      <td>9269.0</td>
      <td>2821.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>5807.0</td>
      <td>NaN</td>
      <td>3888.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>888.0</td>
      <td>NaN</td>
      <td>4287.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>5695.0</td>
      <td>1535.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>82584.0</td>
      <td>5328.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Bạn hình dung ra nội dung của bảng thống kê trên chứ?</p>
<p>Bảng thống kê trên sẽ tính tổng số thuế thu được phân theo các cột là <code class="docutils literal notranslate"><span class="pre">tax_labels</span></code> và <code class="docutils literal notranslate"><span class="pre">chas</span></code> (tax_labels gồm low, normal và high và chas gồm 0-không bao bởi sông, 1-bao bởi sông).</p>
<p>Các dòng lại được phân nhóm theo chỉ số mức độ tiếp cận đường cao tốc <code class="docutils literal notranslate"><span class="pre">rad</span></code> gồm các giá trị <code class="docutils literal notranslate"><span class="pre">1,2,3,4,5,6,7,8,24</span></code>.</p>
<p>Như vậy ta có thể hình dung được trong công thức của pivot_table, các đối số của nó có ý nghĩa như sau:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code>: List các dimensions của cột mà chúng ta cần thống kê.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: List các dimensions theo dòng mà chúng ta cần thống kê.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code>: List các measurement chúng ta sử dụng để tính toán.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggfunc</span></code>: Qui định hàm số chúng ta sẽ dùng để biến đổi measurement. Trong ví dụ này chúng ta áp dụng hàm np.sum cho toán bộ các measurement.</p></li>
</ul>
<p><strong>Làm sao để qui định mỗi measurement một công thức?</strong></p>
<p>Giả sử chúng ta cần tính thêm trung bình số phòng trên căn hộ. Tức là thêm trung bình của trường <code class="docutils literal notranslate"><span class="pre">rm</span></code> trong khi vẫn cần tính tổng của trường <code class="docutils literal notranslate"><span class="pre">tax</span></code>. Khi đó cần khai báo <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> dưới dạng một dictionary có key là tên của measurement và value là công thức của measurement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> 
               <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tax_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;chas&#39;</span><span class="p">],</span> 
               <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">],</span> 
               <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;rm&#39;</span><span class="p">],</span>
               <span class="n">aggfunc</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="s1">&#39;tax&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span>
                   <span class="s1">&#39;rm&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span>
                   <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">rm</th>
      <th colspan="6" halign="left">tax</th>
    </tr>
    <tr>
      <th>tax_labels</th>
      <th colspan="2" halign="left">low</th>
      <th colspan="2" halign="left">normal</th>
      <th colspan="2" halign="left">high</th>
      <th colspan="2" halign="left">low</th>
      <th colspan="2" halign="left">normal</th>
      <th colspan="2" halign="left">high</th>
    </tr>
    <tr>
      <th>chas</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>rad</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6.23000</td>
      <td>7.9230</td>
      <td>6.49553</td>
      <td>NaN</td>
      <td>6.54000</td>
      <td>NaN</td>
      <td>241.0</td>
      <td>198.0</td>
      <td>4968.0</td>
      <td>NaN</td>
      <td>422.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.08611</td>
      <td>NaN</td>
      <td>6.98827</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1800.0</td>
      <td>NaN</td>
      <td>4456.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.44259</td>
      <td>6.8055</td>
      <td>6.38275</td>
      <td>NaN</td>
      <td>6.66600</td>
      <td>NaN</td>
      <td>6424.0</td>
      <td>446.0</td>
      <td>1208.0</td>
      <td>NaN</td>
      <td>1273.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.79033</td>
      <td>NaN</td>
      <td>6.10201</td>
      <td>6.17875</td>
      <td>5.96652</td>
      <td>NaN</td>
      <td>2155.0</td>
      <td>NaN</td>
      <td>20434.0</td>
      <td>2147.0</td>
      <td>12222.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.46277</td>
      <td>7.6450</td>
      <td>6.50922</td>
      <td>6.07067</td>
      <td>5.98217</td>
      <td>6.44614</td>
      <td>2853.0</td>
      <td>216.0</td>
      <td>22175.0</td>
      <td>828.0</td>
      <td>9269.0</td>
      <td>2821.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.11888</td>
      <td>NaN</td>
      <td>6.07800</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5807.0</td>
      <td>NaN</td>
      <td>3888.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.03025</td>
      <td>NaN</td>
      <td>6.53008</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>888.0</td>
      <td>NaN</td>
      <td>4287.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.02463</td>
      <td>6.67020</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5695.0</td>
      <td>1535.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.98414</td>
      <td>6.61137</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>82584.0</td>
      <td>5328.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Bảng của chúng ta đã tăng gấp đôi số cột. Dòng đầu tiên của bảng là <code class="docutils literal notranslate"><span class="pre">rm</span></code>, <code class="docutils literal notranslate"><span class="pre">tax</span></code> là những thông tin ứng với từng measurement.</p>
<p>Bạn thấy đó, <code class="docutils literal notranslate"><span class="pre">pd.pivot_table()</span></code> hoàn toàn đơn giản và rất hiệu quả phải không nào?</p>
</div>
</div>
<div class="section" id="join-merge-va-concatenate-bang">
<h1>2.5. Join, Merge và Concatenate bảng<a class="headerlink" href="#join-merge-va-concatenate-bang" title="Permalink to this headline">¶</a></h1>
<p>Những doanh nghiệp lớn thường tổ chức cơ sở dữ liệu dưới dạng những bảng dữ liệu có quan hệ. Những bảng này được liên kết với nhau bởi key dưới những quan hệ dữ liệu như one-to-one, many-to-one hoặc one-to-many. Những kiến trúc phổ biến trong data warehouse như <code class="docutils literal notranslate"><span class="pre">star</span> <span class="pre">schema</span></code> và <code class="docutils literal notranslate"><span class="pre">snowflake</span> <span class="pre">schema</span></code> sẽ giúp cho chúng ta nhanh chóng join các bảng lại với nhau để tạo ra những bảng raw data tổng hợp phục vụ cho các nhu cầu phân tích, thống kê và xây dựng mô hình.</p>
<p>Ngoài ngôn ngữ SQL là công cụ chính để làm việc với những hệ cơ sở dữ liệu có quan hệ, Data scientist cũng cần nắm vững những kỹ năng liên kết join, merge và concatenate bảng trên pandas mà thông qua chương này mình sẽ giới thiệu tới các bạn.</p>
<div class="section" id="cac-kieu-join">
<h2>2.5.1. Các kiểu join<a class="headerlink" href="#cac-kieu-join" title="Permalink to this headline">¶</a></h2>
<p>Chúng ta có 4 kiểu join chính là <code class="docutils literal notranslate"><span class="pre">left</span> <span class="pre">join,</span> <span class="pre">right</span> <span class="pre">join,</span> <span class="pre">inner</span> <span class="pre">join,</span> <span class="pre">full</span> <span class="pre">join</span></code> được thể hiện qua biểu đồ venn bên dưới:</p>
<p><img alt="" src="https://www.dofactory.com/img/sql/sql-joins.png" /></p>
<p>Chúng ta có hai bảng bên trái và bên phải với những phần thông tin chung (giao nhau giữa hai vòng tròn) và riêng. Phần diện tích màu xanh lá cây là Kết quả của phép join. Chúng ta có thể hình dung kết quả của phép join đó là:</p>
<ul class="simple">
<li><p>left join: Lấy bảng bên trái làm gốc và đưa thêm thông tin bảng bên phải nếu nó xuất hiện ở bảng bên trái.</p></li>
<li><p>right join: Tương tự như left join nhưng bảng bên phải sẽ làm gốc.</p></li>
<li><p>inner join: Lấy những thông tin mà xuất hiện <strong>đồng thời</strong> ở cả hai bảng.</p></li>
<li><p>full join: Lấy những thông tin xuất hiện ở <strong>một trong hai</strong> bảng.</p></li>
</ul>
<p>Bên dưới chúng ta cùng thực hành join.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_sinhvien</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;ID&#39;</span><span class="p">:[</span><span class="s1">&#39;001&#39;</span><span class="p">,</span> <span class="s1">&#39;002&#39;</span><span class="p">,</span> <span class="s1">&#39;003&#39;</span><span class="p">,</span> <span class="s1">&#39;004&#39;</span><span class="p">,</span> <span class="s1">&#39;005&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:[</span><span class="s1">&#39;Pham Van Nghia&#39;</span><span class="p">,</span> <span class="s1">&#39;Tong Thuy Linh&#39;</span><span class="p">,</span> <span class="s1">&#39;Le Van Dai&#39;</span><span class="p">,</span> <span class="s1">&#39;Tran Quang Nghia&#39;</span><span class="p">,</span> <span class="s1">&#39;Doan Thu Ha&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
    <span class="s1">&#39;Province&#39;</span><span class="p">:[</span><span class="s1">&#39;Nam Dinh&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanh Hoa&#39;</span><span class="p">,</span> <span class="s1">&#39;TP Ho Chi Minh&#39;</span><span class="p">,</span> <span class="s1">&#39;Da Nang&#39;</span><span class="p">,</span> <span class="s1">&#39;Can Tho&#39;</span><span class="p">]</span>  
<span class="p">})</span>

<span class="n">df_sinhvien</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_score</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;001&#39;</span><span class="p">,</span> <span class="s1">&#39;002&#39;</span><span class="p">,</span> <span class="s1">&#39;003&#39;</span><span class="p">,</span> <span class="s1">&#39;006&#39;</span><span class="p">,</span> <span class="s1">&#39;007&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.75</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;Physic&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="s1">&#39;Chemistry&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;Province&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Nam Dinh&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanh Hoa&#39;</span><span class="p">,</span> <span class="s1">&#39;TP Ho Chi Minh&#39;</span><span class="p">,</span> <span class="s1">&#39;Quang Nam&#39;</span><span class="p">,</span> <span class="s1">&#39;Nghe An&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">df_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="cau-lenh-pd-merge">
<h2>2.5.2. Câu lệnh pd.merge()<a class="headerlink" href="#cau-lenh-pd-merge" title="Permalink to this headline">¶</a></h2>
<p>Cú pháp chung của câu lện <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> đó là:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">left</span><span class="p">,</span>
    <span class="n">right</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
    <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Trong đó một số trường quan trọng:</p>
<ul class="simple">
<li><p>left: bảng bên trái</p></li>
<li><p>right: bảng bên phải</p></li>
<li><p>how: Phương pháp join gồm <code class="docutils literal notranslate"><span class="pre">left,</span> <span class="pre">right,</span> <span class="pre">inner,</span> <span class="pre">outer</span></code></p></li>
<li><p>left_on: Trường ở bảng bên trái sử dụng để join</p></li>
<li><p>right_on: Trường ở bảng bên phải sử dụng để join</p></li>
<li><p>left_index: Mặc định là False. Nếu True, sử dụng row index ở bảng bên trái như là trường join.</p></li>
<li><p>right_index: Mặc định là False. Nếu True, sử dụng row index ở bảng bên phải như là trường join.</p></li>
<li><p>suffixes: Nếu hai bảng tồn tại các trường trùng nhau thì sử dụng suffix để phân biệt trường nào thuộc bảng nào. Mặc định là <code class="docutils literal notranslate"><span class="pre">('_x',</span> <span class="pre">'_y')</span></code>.</p></li>
</ul>
<p>Tiếp theo áp dụng câu lệnh trên để merge bảng sinh viên với điểm theo key là ID sinh viên.</p>
<p><strong>inner join:</strong> Theo cách này chỉ ID xuất hiện ở đồng thời hai bảng mới được lựa chọn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> 
         <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="s1">&#39;_Score&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>left join:</strong> Những ID xuất hiện ở bảng bên trái sẽ được lựa chọn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> 
         <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="s1">&#39;_Score&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>right join:</strong> Những ID xuất hiện ở bảng bên phải sẽ được lựa chọn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> 
         <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="s1">&#39;_Score&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25.0</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26.0</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25.0</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>outer join:</strong> Tất cả ID xuất hiện ở bảng bên trái hoặc bảng bên phải sẽ được lựa chọn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> 
         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> 
         <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="s1">&#39;_Score&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25.0</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26.0</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25.0</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23.0</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22.0</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>6</th>
      <td>007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="df-join">
<h2>2.5.3. df.join()<a class="headerlink" href="#df-join" title="Permalink to this headline">¶</a></h2>
<p>DataFrame có một hàm là hàm <em>join()</em> có chức năng tương đương với merge, dùng để liên kết bảng theo các keys.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sinhvien</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_score</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_Score&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID_Sv</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>ID_Score</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>001</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>002</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>003</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
      <td>006</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
      <td>007</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Mặc định bảng sẽ join theo index của dòng, các đối số lsuffix<code class="docutils literal notranslate"><span class="pre">và</span></code>rsuffix`lần lượt được sử dụng để qui định hậu tố (<em>suffix</em>) cho bảng bên trái và bảng bên phải nếu xuất hiện trường trùng tên.</p>
<p>Nếu muốn thực hiện hàm <code class="docutils literal notranslate"><span class="pre">join()</span></code> theo một trường nào đó, chúng ta phải thiết lập index cho bảng là trường cần join rồi sau đó mới thực hiện join. Ví dụ bạn cần join theo ID:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Thiết lập index</span>
<span class="n">df_sinhvien</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df_score</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Join bảng</span>
<span class="n">df_sinhvien</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_score</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_Sv&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_Score&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Province_Sv</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province_Score</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>001</th>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>002</th>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>003</th>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>004</th>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>005</th>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset lại index</span>
<span class="n">df_sinhvien</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df_score</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cau-lenh-pd-concat">
<h2>2.5.4. Câu lệnh pd.concat()<a class="headerlink" href="#cau-lenh-pd-concat" title="Permalink to this headline">¶</a></h2>
<p>Câu lệnh <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> được sử dụng để nối hai bảng theo dòng hoặc theo cột. Đây là câu lệnh được sử dụng khá phổ biến để tạo bảng tổng hợp từ các bảng dữ liệu nhỏ. Một ví dụ khá cụ thể đó là trong package <a class="reference external" href="https://github.com/phamdinhkhanh/vnquant">vnquant</a> dữ liệu mỗi mã chứng khoán sẽ bị phân trang. Nếu download lần lượt trừng trang thì sẽ lâu, do đó để tăng tốc thì chúng ta sẽ download song song nhiều trang một lúc và sử dụng lệnh <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> để nối dữ liệu thành một bảng chính.</p>
<p>Cú pháp chung của lệnh <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> sẽ như sau:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
  <span class="n">objs</span><span class="p">,</span> 
  <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
  <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> 
  <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
  <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
  <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
  <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
  <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
  <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
  <span class="n">copy</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Trong đó:</p>
<ul class="simple">
<li><p>objs: Là list các bảng cần concanate.</p></li>
<li><p>axis: Mặc đinh là 0, nối theo dòng. Trái lại là 1 nếu nối theo cột.</p></li>
<li><p>join: <code class="docutils literal notranslate"><span class="pre">inner</span></code> chỉ lấy các dòng hoặc cột có cùng index; <code class="docutils literal notranslate"><span class="pre">outer</span></code> lấy cả các dòng hoặc cột khác index.</p></li>
</ul>
<p><strong>Nếu muốn nối theo dòng thì làm thế nào?</strong></p>
<p>Để nối hai bảng theo dòng thì ta sẽ để <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>, đây là giá trị mặc định của đối số này trong <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>.</p>
<p>Nếu chúng ta muốn nối hai bảng theo dòng và chỉ lấy trường thông tin mà cả hai bảng đều có thì cần thiết lập <code class="docutils literal notranslate"><span class="pre">join='inner'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">],</span> 
          <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Da Nang</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Can Tho</td>
    </tr>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ta cũng có thể nối hai bảng theo dòng và lấy tất cả các trường thông tin ở cả hai bảng thì sẽ thiết lập <code class="docutils literal notranslate"><span class="pre">join='outer'</span></code>. Đây là giá trị mặc định của đối số này. Giá trị <code class="docutils literal notranslate"><span class="pre">NaN</span></code> tự động được fill đối với những thông tin không có.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">],</span> 
          <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25.0</td>
      <td>Nam Dinh</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26.0</td>
      <td>Thanh Hoa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25.0</td>
      <td>TP Ho Chi Minh</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23.0</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22.0</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Quang Nam</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Nghe An</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Làm sao để nối theo cột</strong></p>
<p>Để nối theo cột thì khai báo <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">],</span> 
          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
      <th>ID</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>001</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>002</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>003</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
      <td>006</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
      <td>007</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Khi đó các dòng sẽ được liên kết theo row index ở mỗi bảng. Nếu chúng ta muốn các dòng được liên kết theo một trường nào đó như ‘ID’ thì cần <code class="docutils literal notranslate"><span class="pre">set_index()</span></code> là trường đó trước khi nối.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sinhvien</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">),</span> <span class="n">df_score</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">)],</span> 
          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>001</th>
      <td>Pham Van Nghia</td>
      <td>25.0</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>002</th>
      <td>Tong Thuy Linh</td>
      <td>26.0</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>003</th>
      <td>Le Van Dai</td>
      <td>25.0</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>004</th>
      <td>Tran Quang Nghia</td>
      <td>23.0</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>005</th>
      <td>Doan Thu Ha</td>
      <td>22.0</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>006</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>007</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nếu ta chỉ muốn các dòng mà ID xuất hiện ở cả hai bảng thì thêm <code class="docutils literal notranslate"><span class="pre">join='inner'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sinhvien</span><span class="p">,</span> <span class="n">df_score</span><span class="p">],</span> 
          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
      <th>ID</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
      <th>Province</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25</td>
      <td>Nam Dinh</td>
      <td>001</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>Nam Dinh</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26</td>
      <td>Thanh Hoa</td>
      <td>002</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
      <td>Thanh Hoa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25</td>
      <td>TP Ho Chi Minh</td>
      <td>003</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>TP Ho Chi Minh</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23</td>
      <td>Da Nang</td>
      <td>006</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>Quang Nam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22</td>
      <td>Can Tho</td>
      <td>007</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>Nghe An</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="append">
<h2>2.5.5. append()<a class="headerlink" href="#append" title="Permalink to this headline">¶</a></h2>
<p>Ngoài câu lệnh <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> thì bản thân một dataframe cũng có hàm <code class="docutils literal notranslate"><span class="pre">append()</span></code> được sử dụng để nối bảng <strong>Theo dòng</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sinhvien</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Province</th>
      <th>Math</th>
      <th>Physic</th>
      <th>Chemistry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>Pham Van Nghia</td>
      <td>25.0</td>
      <td>Nam Dinh</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>Tong Thuy Linh</td>
      <td>26.0</td>
      <td>Thanh Hoa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>Le Van Dai</td>
      <td>25.0</td>
      <td>TP Ho Chi Minh</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004</td>
      <td>Tran Quang Nghia</td>
      <td>23.0</td>
      <td>Da Nang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005</td>
      <td>Doan Thu Ha</td>
      <td>22.0</td>
      <td>Can Tho</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Nam Dinh</td>
      <td>6.75</td>
      <td>8.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Thanh Hoa</td>
      <td>9.00</td>
      <td>9.0</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TP Ho Chi Minh</td>
      <td>8.00</td>
      <td>9.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Quang Nam</td>
      <td>7.00</td>
      <td>8.5</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Nghe An</td>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Câu lệnh này sẽ thường được sử dụng trong tình huống bạn muốn tạo bảng tổng hợp từ nhiều bảng con có cùng cấu trúc.</p>
<p>Ví dụ: Bạn muốn tạo ra một bảng về lợi tức chứng khoán của toàn bộ các ngành từ số liệu chứng khoán của từng ngành.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">df_chungkhoan</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Nganh&#39;</span><span class="p">,</span> <span class="s1">&#39;Interest&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
  <span class="n">nganh</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span>
  <span class="n">df_sector</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Nganh&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">nganh</span><span class="p">],</span> <span class="s1">&#39;Interest&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="n">df_chungkhoan</span> <span class="o">=</span> <span class="n">df_chungkhoan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_sector</span><span class="p">)</span>

<span class="n">df_chungkhoan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nganh</th>
      <th>Interest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>t</td>
      <td>0.00551</td>
    </tr>
    <tr>
      <th>1</th>
      <td>j</td>
      <td>0.00977</td>
    </tr>
    <tr>
      <th>2</th>
      <td>p</td>
      <td>-0.00602</td>
    </tr>
    <tr>
      <th>3</th>
      <td>u</td>
      <td>0.00962</td>
    </tr>
    <tr>
      <th>4</th>
      <td>m</td>
      <td>-0.00468</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="ket-noi-sql">
<h1>2.6. Kết nối SQL<a class="headerlink" href="#ket-noi-sql" title="Permalink to this headline">¶</a></h1>
<p>Đối với những data scientist làm việc trong những doanh nghiệp quản lý dữ liệu trên data warehouse như Ngân Hàng, công ty Chứng Khoán, Bảo Hiểm thì thường xuyên phải kết nối SQL để truy vấn dữ liệu. Python có rất nhiều các packages cung cấp instance connection tới SQL cũng như biến đổi data trên cú pháp của SQL. Mình sẽ không thể giới thiệu hết toàn bộ những packages này mà sẽ giới thiệu tới các bạn hai packages phổ biến nhất đó là:</p>
<p><strong>sqlalchemy</strong></p>
<p>Đây là một pakage cho phép chúng ta kết nối và truy vấn trên những dữ liệu SQL một cách trực tiếp theo mô hình server-client side. Chúng ta sẽ phải khai báo một số thông tin quan trọng để khởi tạo kết nối như:</p>
<ul class="simple">
<li><p>Tên server là gì?</p></li>
<li><p>Tên database trong server cần truy vấn.</p></li>
<li><p>port: Cổng kết nối, thường mặc định của MSSQL là 1443.</p></li>
<li><p>username: Tên user.</p></li>
<li><p>password: Mật khẩu truy cập.</p></li>
</ul>
<p><strong>Chú ý</strong>: Ở phần ví dụ thực hành liên quan tới SQL thì mỗi máy sẽ có một cấu hình khác nhau. Để thực hành được code bên dưới trước tiên máy tính của bạn cần cài SQL Server và có sẵn những database trong server.</p>
<p>Bạn sẽ cần khai báo đúng các trường cấu hình truy cập trong <code class="docutils literal notranslate"><span class="pre">DB</span></code> và tên bảng tại <code class="docutils literal notranslate"><span class="pre">TableName</span></code>.</p>
<p>Nếu bạn thực hành bị lỗi các ví dụ tại mục 3 này, hãy tạm thời bỏ qua chúng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

from sqlalchemy import create_engine, MetaData, Table, select, engine
# Create parameters
TableName = &#39;WorkOrder&#39;

DB = {
    &#39;drivername&#39;: &#39;mssql+pyodbc&#39;,
    &#39;servername&#39;: &#39;LAPTOPTCC-PC&#39;,
    #&#39;port&#39;: &#39;1443&#39;,
    #&#39;username&#39;: &#39;&#39;,
    #&#39;password&#39;: &#39;&#39;,
    &#39;database&#39;: &#39;TestDB&#39;,
    &#39;driver&#39;: &#39;SQL Server Native Client 11.0&#39;,
    &#39;trusted_connection&#39;: &#39;yes&#39;,
    &#39;legacy_schema_aliasing&#39;: False
}

# Create the connection
engine = create_engine(DB[&#39;drivername&#39;] + &#39;://&#39; + DB[&#39;servername&#39;] + &#39;/&#39; + DB[&#39;database&#39;] + &#39;?&#39; + &#39;driver=&#39; + DB[&#39;driver&#39;] 
+ &#39;;&#39; + &#39;trusted_connection=&#39; + DB[&#39;trusted_connection&#39;], legacy_schema_aliasing=DB[&#39;legacy_schema_aliasing&#39;])

conn = engine.connect()

# Required for querying tables
metadata = MetaData(conn)

#Table to query
tbl = Table(TableName, metadata, autoload = True, schema = &#39;dbo&#39;)
# tbl.create(checkfirst = True)

#select all
sql = tbl.select()

#run sql code
result = conn.execute(sql)

df3 = pd.DataFrame(data = list(result), columns = result.keys())
df3.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
<p>Sau khi sử dụng connection thì chúng ta nhớ đóng lại connection để giải phóng memory và port.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

#close connection to free memory
conn.close()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
<p>Chúng ta cũng có thể thực thi các lệnh của SQL thông qua engine SQL mà chúng ta đã khởi tạo. Kết quả sẽ được truy vấn và tính toán trực tiếp từ server trả về  như câu lệnh ta yêu cầu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

#another way, use read_sql_query() function from pandas. This function use directly engine without initialize connection
pd.read_sql_query(&quot;SELECT TOP 5 * FROM WorkOrder&quot;, engine)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
<p><strong>pyodbc</strong></p>
<p>Đây là package được thiết kế riêng để truy vấn trên những hệ cơ sở dữ liệu sử dụng kết nối ODBC của Microsoft.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

import pandas.io.sql
import pyodbc

server = &#39;LAPTOPTCC-PC&#39;
db = &#39;AdventureWorks&#39;

#create connection
conn = pyodbc.connect(&#39;DRIVER={SQL Server};SERVER=&#39; 
                      + DB[&#39;servername&#39;]
                      + &#39;;DATABASE=&#39; 
                      + DB[&#39;database&#39;] 
                      + &#39;;Trusted_Connection=yes&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
<p>Sau khi khởi tạo kết nối thì ta cũng có thể sử dụng các câu lệnh của SQL như thông thường để truy vấn và tính toán thông tin như bên dưới:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

#query db
sql = &quot;&quot;&quot;SELECT * FROM WorkOrder&quot;&quot;&quot;

df4 = pandas.io.sql.read_sql(sql, conn)
df4.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
<p><strong>Cursor cho SQL</strong></p>
<p>Cursor là một con trỏ dẫn tới một vùng nhớ mà lưu trữ dữ liệu. Sử dụng cursor sẽ giúp ta tiết kiệm bộ nhớ vì chúng ta không phải phân bổ bộ nhớ cho dữ liệu ngay mà chỉ sử dụng địa chỉ để trỏ tới dữ liệu. Cursor được sử dụng phổ biến trong SQL đặc biệt là trong các vòng for. Trong <code class="docutils literal notranslate"><span class="pre">pyodbc</span></code> chúng ta sẽ sử dụng <code class="docutils literal notranslate"><span class="pre">cursor()</span></code> trong vòng for để duyệt qua các dòng như bên dưới:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> echo skipping

import pyodbc

con = pyodbc.connect(&quot;DRIVER={SQL Server};&quot;
                     &quot;SERVER=LAPTOPTCC-PC;&quot;
                     &quot;DATASET=AdventureWorksDW2012;&quot;
                     &quot;Trusted_Connection=yes;&quot;)
cursor = con.cursor()

cursor.execute(&quot;SELECT TOP 10 * FROM AdventureWorksDW2012.dbo.DimCustomer&quot;)

for row in cursor.fetchall():
    print(&#39;row = &#39;, row)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>skipping
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tong-ket">
<h1>2.7. Tổng kết<a class="headerlink" href="#tong-ket" title="Permalink to this headline">¶</a></h1>
<p>Qua bài hướng dẫn này bạn đã được làm quen với những chức năng của pandas trong phân tích, xử lý và biến đổi dữ liệu. Tổng kết lại chúng ta đã đi qua các mục:</p>
<ul class="simple">
<li><p>Cách đọc, lưu và khởi tạo dataframe</p></li>
<li><p>Thao tác dữ liệu trên dataframe: truy cập bảng, sort, filter và các hàm cơ bản trên dataframe.</p></li>
<li><p>Thay đổi shape của bảng qua melt và dummy.</p></li>
<li><p>Thống kê theo groupby và pivot_table.</p></li>
<li><p>Các lệnh join, merge, concatenate bảng.</p></li>
<li><p>Kết nối với dữ liệu SQL.</p></li>
</ul>
<p>Những kiến thức trên không cover hết toàn bộ về pandas nhưng là những kiến thức hay dùng nên bạn đọc cần nắm vững.</p>
<p>Tiếp theo là bài tập thực hành cho bài viết này.</p>
</div>
<div class="section" id="bai-tap">
<h1>2.8. Bài tập<a class="headerlink" href="#bai-tap" title="Permalink to this headline">¶</a></h1>
<p>Sử dụng bộ dữ liệu <a class="reference external" href="https://raw.githubusercontent.com/phamdinhkhanh/datasets/master/Churn_Modelling.csv">Churn Customer</a> bạn hãy.</p>
<ol class="simple">
<li><p>Đọc dữ liệu từ file csv, có phần header là row thứ nhất và index là trường RowNumber.</p></li>
<li><p>Thống kê mô tả đối với các trường trong bảng dữ liệu này.</p></li>
<li><p>Tính trung bình điểm <code class="docutils literal notranslate"><span class="pre">CreditScore</span></code> theo <code class="docutils literal notranslate"><span class="pre">Geography</span></code>.</p></li>
<li><p>Phân đều <code class="docutils literal notranslate"><span class="pre">Age</span></code> thành 5 nhóm độ tuổi sao cho mỗi nhóm chiếm 20% số quan sát.</p></li>
<li><p>Vẽ biểu đồ barchart thống kê số lượng khách hàng theo nhóm độ tuổi vừa tạo được.</p></li>
</ol>
</div>
<div class="section" id="tai-lieu">
<h1>2.9. Tài liệu<a class="headerlink" href="#tai-lieu" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html">pandas-docs</a></p></li>
<li><p><a class="reference external" href="https://www.w3schools.com/python/pandas/default.asp">pandas-tutorial w3school</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/index.html">pandas introduction - pandas.pydata.org</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/frame.html">pandas dataframe - pandas.pydata.org</a></p></li>
</ol>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch_appendix"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="index_pandas.html" title="previous page">2. Pandas</a>
    <a class='right-next' id="next-link" href="index_numpy.html" title="next page">3. Numpy</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Pham Dinh Khanh<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>